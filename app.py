import streamlit as st
import datetime

st.set_page_config(page_title="è‹±è¯­å†™ä½œè¾…åŠ©å¹³å°ï¼ˆç¦»çº¿æ¼”ç¤ºï¼‰", layout="wide")
st.title("âœ è‹±è¯­å†™ä½œè¾…åŠ©å¹³å°ï¼ˆç¦»çº¿æ¼”ç¤ºï¼‰")

st.markdown("è¯·è¾“å…¥ä½ çš„è‹±æ–‡æ®µè½ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œæˆ‘ä»¬å°†ä¸ºä½ æ¨¡æ‹Ÿæä¾›çº é”™ã€æ¶¦è‰²ã€è¯„åˆ†å’Œå†™ä½œåæ€å»ºè®®ï¼š")

user_input = st.text_area("è¾“å…¥è‹±æ–‡æ®µè½", height=300)

if st.button("å¼€å§‹æ¨¡æ‹Ÿåˆ†æ"):
    if not user_input.strip():
        st.warning("è¯·è¾“å…¥ä¸€äº›è‹±æ–‡æ–‡æœ¬")
    else:
        with st.spinner("æ¨¡æ‹Ÿåˆ†æä¸­..."):
            # æ¨¡æ‹Ÿå“åº”å†…å®¹
            mock_correction = user_input.replace("i", "I").replace("dont", "don't") + " (grammar fixed)"

            col1, col2 = st.columns(2)

            with col1:
                st.subheader("ä¿®æ­£å»ºè®®")
                st.write(mock_correction)

                st.subheader("è¯„åˆ†")
                st.write("""
                - Logic: 7/10
                - Language Use: 6/10
                - Structure: 8/10
                """)

            with col2:
                st.subheader("å†™ä½œç­–ç•¥å»ºè®®ï¼ˆèåˆå…ƒè®¤çŸ¥å¼•å¯¼ï¼‰")
                st.markdown("""
                - **è®¡åˆ’é˜¶æ®µ**ï¼šåœ¨å†™ä½œå‰ï¼Œæƒ³ä¸€æƒ³ä½ æƒ³è¡¨è¾¾çš„ä¸»è¦è§‚ç‚¹å’Œç»“æ„æ¡†æ¶ã€‚
                - **ç›‘æ§é˜¶æ®µ**ï¼šåœ¨å†™ä½œä¸­ä¸æ–­é—®è‡ªå·±ï¼šè¿™å¥è¯æ˜¯å¦æ”¯æŒä¸­å¿ƒè®ºç‚¹ï¼Ÿè¯­æ³•æ­£ç¡®å—ï¼Ÿ
                - **è¯„ä¼°é˜¶æ®µ**ï¼šå®Œæˆåè‡ªæŸ¥å†…å®¹æ˜¯å¦è¿è´¯ï¼Œæ˜¯å¦è¾¾æˆäº†å†™ä½œç›®æ ‡ã€‚
                """)

                st.subheader("ğŸª å†™ä½œåæ€å»ºè®®")
                st.markdown("""
                - åœ¨æœªæ¥å†™ä½œä¸­ï¼Œå¯ä»¥æ›´åŠ æ³¨æ„å¥å­è¡”æ¥ä¸æ®µè½è¿‡æ¸¡ã€‚
                - å°è¯•åœ¨ä¿®æ”¹æ—¶æœ—è¯»æ–‡ç« ï¼Œå¸®åŠ©å‘ç°ä¸é€šé¡ºçš„éƒ¨åˆ†ã€‚
                """)

            st.markdown("---")
            st.download_button(
                label="ğŸ“¥ ä¸‹è½½åˆ†ææŠ¥å‘Š (Word æ–‡æ¡£)",
                data=f"""
è‹±è¯­å†™ä½œåˆ†ææŠ¥å‘Š - {datetime.date.today()}

åŸå§‹å†…å®¹ï¼š
{user_input}

ä¿®æ­£å»ºè®®ï¼š
{mock_correction}

è¯„åˆ†ï¼š
- Logic: 7/10
- Language Use: 6/10
- Structure: 8/10

å†™ä½œç­–ç•¥å»ºè®®ï¼š
1. è®¡åˆ’å†™ä½œç›®æ ‡ä¸ç»“æ„
2. ç›‘æ§è¯­æ³•ä¸é€»è¾‘
3. è¯„ä¼°æˆæœä¸åé¦ˆ

å†™ä½œåæ€ï¼š
- å¼ºåŒ–ç»“æ„è¿è´¯æ€§
- åˆ©ç”¨æœ—è¯»å‘ç°é—®é¢˜
                """,
                file_name="writing_feedback.docx",
                mime="text/plain"
            )

st.markdown("---")
st.markdown("å½“å‰ä¸ºç¦»çº¿æ¨¡æ‹Ÿç‰ˆæœ¬ã€‚å¦‚éœ€çœŸå® AI åˆ†æï¼Œè¯·é…ç½® OpenAI API Keyã€‚")
